---

title: Feature Engineering und Target Variablen

keywords: fastai
sidebar: home_sidebar

summary: "In diesem Modul werden zusätzliche Features berechnet und die Zielvariablen sowie Test und Train split definiert."
description: "In diesem Modul werden zusätzliche Features berechnet und die Zielvariablen sowie Test und Train split definiert."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_features.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autotime
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 185 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 338 µs
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_data" class="doc_header"><code>load_data</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/features.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_data</code>(<strong><code>path</code></strong>=<em><code>'data/interim/02_train.csv'</code></em>)</p>
</blockquote>
<p>load data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 18.3 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>ind_empleado</th>
      <th>pais_residencia</th>
      <th>sexo</th>
      <th>age</th>
      <th>ind_nuevo</th>
      <th>antiguedad</th>
      <th>indrel</th>
      <th>indrel_1mes</th>
      <th>tiprel_1mes</th>
      <th>...</th>
      <th>month_int</th>
      <th>fecha_alta_month</th>
      <th>fecha_alta_year</th>
      <th>fecha_alta_day</th>
      <th>fecha_alta_month_int</th>
      <th>fecha_alta_day_int</th>
      <th>ult_fec_cli_1t_month</th>
      <th>ult_fec_cli_1t_year</th>
      <th>ult_fec_cli_1t_day</th>
      <th>ult_fec_cli_1t_month_int</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1018027</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>35</td>
      <td>0</td>
      <td>38</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>5</td>
      <td>17</td>
      <td>30</td>
      <td>209</td>
      <td>6385</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1312827</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>22</td>
      <td>0</td>
      <td>10</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>9</td>
      <td>19</td>
      <td>22</td>
      <td>237</td>
      <td>7227</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>2</th>
      <td>239244</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>41</td>
      <td>0</td>
      <td>171</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>4</td>
      <td>6</td>
      <td>10</td>
      <td>76</td>
      <td>2320</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1096938</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>23</td>
      <td>0</td>
      <td>32</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>11</td>
      <td>17</td>
      <td>7</td>
      <td>215</td>
      <td>6542</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>4</th>
      <td>259247</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>56</td>
      <td>0</td>
      <td>168</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>4</td>
      <td>9</td>
      <td>12</td>
      <td>112</td>
      <td>3417</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1096948</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>23</td>
      <td>0</td>
      <td>32</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>11</td>
      <td>17</td>
      <td>7</td>
      <td>215</td>
      <td>6542</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>6</th>
      <td>951377</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>37</td>
      <td>0</td>
      <td>46</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>9</td>
      <td>16</td>
      <td>29</td>
      <td>201</td>
      <td>6139</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>7</th>
      <td>428293</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>42</td>
      <td>0</td>
      <td>144</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>8</td>
      <td>21</td>
      <td>103</td>
      <td>3151</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>8</th>
      <td>259245</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>54</td>
      <td>0</td>
      <td>168</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>7</td>
      <td>6</td>
      <td>4</td>
      <td>79</td>
      <td>2404</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1154223</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>49</td>
      <td>0</td>
      <td>23</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>8</td>
      <td>18</td>
      <td>2</td>
      <td>224</td>
      <td>6812</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 56 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 13.4 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 16.4 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">target_cols</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ind_cco_fin_ult1     7110470
ind_cder_fin_ult1       4544
ind_cno_fin_ult1      953036
ind_ctju_fin_ult1     111560
ind_ctma_fin_ult1     100151
ind_ctop_fin_ult1    1494665
ind_ctpp_fin_ult1     508713
ind_deco_fin_ult1      18439
ind_deme_fin_ult1      19128
ind_dela_fin_ult1     505756
ind_ecue_fin_ult1     971571
ind_fond_fin_ult1     215673
ind_hip_fin_ult1       70728
ind_plan_fin_ult1     109810
ind_pres_fin_ult1      28475
ind_reca_fin_ult1     623697
ind_tjcr_fin_ult1     526745
ind_valo_fin_ult1     296541
ind_viv_fin_ult1       46521
ind_nomina_ult1       647960
ind_nom_pens_ult1     704080
ind_recibo_ult1      1492387
dtype: int64</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 580 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="calculate-target-vars">calculate target vars<a class="anchor-link" href="#calculate-target-vars"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 1.23 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calculate_targets" class="doc_header"><code>calculate_targets</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/features.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calculate_targets</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>feature_cols</code></strong>:<code>list</code>=<em><code>['ind_empleado', 'sexo', 'age', 'renta', 'ind_nuevo', 'indrel', 'indrel_1mes', 'tiprel_1mes', 'indresi', 'indext', 'conyuemp', 'indfall', 'tipodom', 'ind_actividad_cliente', 'segmento', 'antiguedad', 'pais_residencia', 'canal_entrada']</code></em>, <strong><code>target_products</code></strong>:<code>list</code>=<em><code>['ind_cco_fin_ult1', 'ind_cder_fin_ult1', 'ind_cno_fin_ult1', 'ind_ctju_fin_ult1', 'ind_ctma_fin_ult1', 'ind_ctop_fin_ult1', 'ind_ctpp_fin_ult1', 'ind_deco_fin_ult1', 'ind_deme_fin_ult1', 'ind_dela_fin_ult1', 'ind_ecue_fin_ult1', 'ind_fond_fin_ult1', 'ind_hip_fin_ult1', 'ind_plan_fin_ult1', 'ind_pres_fin_ult1', 'ind_reca_fin_ult1', 'ind_tjcr_fin_ult1', 'ind_valo_fin_ult1', 'ind_viv_fin_ult1', 'ind_nomina_ult1', 'ind_nom_pens_ult1', 'ind_recibo_ult1']</code></em>, <strong><code>remove_wrong_shift_entries</code></strong>=<em><code>True</code></em>, <strong><code>shift_periods</code></strong>=<em><code>1</code></em>)</p>
</blockquote>
<p>add the shifted product values and calculate target variables</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">calculate_targets</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df_s_12</span> <span class="o">=</span> <span class="n">calculate_targets</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">shift_periods</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_s_12</span><span class="p">))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_s_12</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">min</span><span class="p">(</span><span class="n">df_s_12</span><span class="o">.</span><span class="n">month_int</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">==</span> <span class="mi">13</span> <span class="c1">#first month 1 + 12 shift</span>
<span class="k">assert</span> <span class="s1">&#39;ind_ctma_fin_ult1_s&#39;</span> <span class="ow">in</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="c1">#shifted columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>10143523
2569018
time: 39.5 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 423 µs
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_rows_without_product" class="doc_header"><code>remove_rows_without_product</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/features.py#L66" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_rows_without_product</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>target_products</code></strong>:<code>list</code>=<em><code>['ind_cco_fin_ult1', 'ind_cder_fin_ult1', 'ind_cno_fin_ult1', 'ind_ctju_fin_ult1', 'ind_ctma_fin_ult1', 'ind_ctop_fin_ult1', 'ind_ctpp_fin_ult1', 'ind_deco_fin_ult1', 'ind_deme_fin_ult1', 'ind_dela_fin_ult1', 'ind_ecue_fin_ult1', 'ind_fond_fin_ult1', 'ind_hip_fin_ult1', 'ind_plan_fin_ult1', 'ind_pres_fin_ult1', 'ind_reca_fin_ult1', 'ind_tjcr_fin_ult1', 'ind_valo_fin_ult1', 'ind_viv_fin_ult1', 'ind_nomina_ult1', 'ind_nom_pens_ult1', 'ind_recibo_ult1']</code></em>)</p>
</blockquote>
<p>removes all rows from a train set without new products</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">remove_rows_without_product</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 500 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 3.01 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calculate_target_as_one_column" class="doc_header"><code>calculate_target_as_one_column</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/features.py#L71" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calculate_target_as_one_column</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>feature_cols</code></strong>:<code>list</code>, <strong><code>target_cols</code></strong>:<code>list</code>)</p>
</blockquote>
<p>create a row for every new porduct and give the product name as target column, this is done for the train set</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">calculate_target_as_one_column</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">feature_cols</span><span class="p">,</span> <span class="n">target_cols</span><span class="p">)</span>
<span class="k">assert</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">df3</span><span class="o">.</span><span class="n">columns</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span> <span class="c1">#additional rows as there are more than one product per month</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 385 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="train_test_split">train_test_split<a class="anchor-link" href="#train_test_split"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 566 µs
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_last_month_test_set" class="doc_header"><code>get_last_month_test_set</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/features.py#L87" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_last_month_test_set</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>feature_cols</code></strong>=<em><code>['ind_empleado', 'sexo', 'age', 'renta', 'ind_nuevo', 'indrel', 'indrel_1mes', 'tiprel_1mes', 'indresi', 'indext', 'conyuemp', 'indfall', 'tipodom', 'ind_actividad_cliente', 'segmento', 'antiguedad', 'pais_residencia', 'canal_entrada']</code></em>, <strong><code>target_cols</code></strong>=<em><code>['ind_cco_fin_ult1', 'ind_cder_fin_ult1', 'ind_cno_fin_ult1', 'ind_ctju_fin_ult1', 'ind_ctma_fin_ult1', 'ind_ctop_fin_ult1', 'ind_ctpp_fin_ult1', 'ind_deco_fin_ult1', 'ind_deme_fin_ult1', 'ind_dela_fin_ult1', 'ind_ecue_fin_ult1', 'ind_fond_fin_ult1', 'ind_hip_fin_ult1', 'ind_plan_fin_ult1', 'ind_pres_fin_ult1', 'ind_reca_fin_ult1', 'ind_tjcr_fin_ult1', 'ind_valo_fin_ult1', 'ind_viv_fin_ult1', 'ind_nomina_ult1', 'ind_nom_pens_ult1', 'ind_recibo_ult1']</code></em>)</p>
</blockquote>
<p>calculates test set for all new products in the last month</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df4_test</span> <span class="o">=</span> <span class="n">get_last_month_test_set</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">df4_test</span><span class="o">.</span><span class="n">month_int</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">17</span>
<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">month_int</span> <span class="o">==</span> <span class="mi">17</span><span class="p">][</span><span class="s1">&#39;month_int&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">df4_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 1.29 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 593 µs
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_train_set" class="doc_header"><code>get_train_set</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/features.py#L95" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_train_set</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>feature_cols</code></strong>=<em><code>['ind_empleado', 'sexo', 'age', 'renta', 'ind_nuevo', 'indrel', 'indrel_1mes', 'tiprel_1mes', 'indresi', 'indext', 'conyuemp', 'indfall', 'tipodom', 'ind_actividad_cliente', 'segmento', 'antiguedad', 'pais_residencia', 'canal_entrada']</code></em>, <strong><code>target_cols</code></strong>=<em><code>['ind_cco_fin_ult1', 'ind_cder_fin_ult1', 'ind_cno_fin_ult1', 'ind_ctju_fin_ult1', 'ind_ctma_fin_ult1', 'ind_ctop_fin_ult1', 'ind_ctpp_fin_ult1', 'ind_deco_fin_ult1', 'ind_deme_fin_ult1', 'ind_dela_fin_ult1', 'ind_ecue_fin_ult1', 'ind_fond_fin_ult1', 'ind_hip_fin_ult1', 'ind_plan_fin_ult1', 'ind_pres_fin_ult1', 'ind_reca_fin_ult1', 'ind_tjcr_fin_ult1', 'ind_valo_fin_ult1', 'ind_viv_fin_ult1', 'ind_nomina_ult1', 'ind_nom_pens_ult1', 'ind_recibo_ult1']</code></em>, <strong><code>product_shift</code></strong>=<em><code>1</code></em>)</p>
</blockquote>
<p>retunrs the trainset. Take care that you don't include the test data to this function</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df5_train</span> <span class="o">=</span> <span class="n">get_train_set</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">assert</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">df5_train</span><span class="o">.</span><span class="n">columns</span>
<span class="k">assert</span> <span class="s1">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">df5_train</span><span class="o">.</span><span class="n">columns</span>
<span class="k">assert</span> <span class="n">df5_train</span><span class="o">.</span><span class="n">month_int</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="mi">16</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 8.09 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df5_train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ind_empleado</th>
      <th>sexo</th>
      <th>age</th>
      <th>renta</th>
      <th>ind_nuevo</th>
      <th>indrel</th>
      <th>indrel_1mes</th>
      <th>tiprel_1mes</th>
      <th>indresi</th>
      <th>indext</th>
      <th>...</th>
      <th>ind_reca_fin_ult1_s</th>
      <th>ind_tjcr_fin_ult1_s</th>
      <th>ind_valo_fin_ult1_s</th>
      <th>ind_viv_fin_ult1_s</th>
      <th>ind_nomina_ult1_s</th>
      <th>ind_nom_pens_ult1_s</th>
      <th>ind_recibo_ult1_s</th>
      <th>month_int</th>
      <th>id</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>0</td>
      <td>56</td>
      <td>326124</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>15889</td>
      <td>ind_tjcr_fin_ult1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>0</td>
      <td>56</td>
      <td>326124</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>15889</td>
      <td>ind_tjcr_fin_ult1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0</td>
      <td>56</td>
      <td>326124</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
      <td>15889</td>
      <td>ind_tjcr_fin_ult1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>61</td>
      <td>430477</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>15892</td>
      <td>ind_cco_fin_ult1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>1</td>
      <td>61</td>
      <td>430477</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>15892</td>
      <td>ind_dela_fin_ult1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>401240</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>1454615</td>
      <td>ind_cno_fin_ult1</td>
    </tr>
    <tr>
      <th>401241</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>1454615</td>
      <td>ind_nomina_ult1</td>
    </tr>
    <tr>
      <th>401242</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>1454615</td>
      <td>ind_nom_pens_ult1</td>
    </tr>
    <tr>
      <th>401243</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
      <td>1454615</td>
      <td>ind_nomina_ult1</td>
    </tr>
    <tr>
      <th>401244</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
      <td>1454615</td>
      <td>ind_nom_pens_ult1</td>
    </tr>
  </tbody>
</table>
<p>401245 rows × 43 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 67.4 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 62 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="calculate_main" class="doc_header"><code>calculate_main</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/features.py#L105" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>calculate_main</code>(<strong><code>source</code></strong>:"source csv file"=<em><code>'data/interim/02_train.csv'</code></em>, <strong><code>dest_train</code></strong>:"destination train csv file"=<em><code>'data/interim/03_train.csv'</code></em>, <strong><code>dest_test</code></strong>:"destination test csv file"=<em><code>'data/interim/03_test.csv'</code></em>, <strong><code>shift_periods</code></strong>:"how many periods to shift target_vars"=<em><code>1</code></em>)</p>
</blockquote>
<p>calculate target variables and delayed product features</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">calculate_main</span><span class="p">()</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">calculate_main</span><span class="p">(</span>
    <span class="n">dest_train</span><span class="o">=</span><span class="s1">&#39;data/interim/03_train_shift12.csv&#39;</span><span class="p">,</span> 
    <span class="n">dest_test</span><span class="o">=</span><span class="s1">&#39;data/interim/03_test_shift12.csv&#39;</span><span class="p">,</span> 
    <span class="n">shift_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">calculate_main</span><span class="p">(</span>
    <span class="n">dest_train</span><span class="o">=</span><span class="s1">&#39;data/interim/03_train_shift6.csv&#39;</span><span class="p">,</span> 
    <span class="n">dest_test</span><span class="o">=</span><span class="s1">&#39;data/interim/03_test_shift6.csv&#39;</span><span class="p">,</span> 
    <span class="n">shift_periods</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(        ind_empleado  sexo  age   renta  ind_nuevo  indrel  indrel_1mes  \
 0                  3     0   56  326124          0       1            1   
 1                  3     1   61  430477          0       1            1   
 2                  3     1   61  430477          0       1            1   
 3                  3     1   61  430477          0       1            1   
 4                  3     1   61  430477          0       1            1   
 ...              ...   ...  ...     ...        ...     ...          ...   
 642455             0     0   37   51702          0       1            1   
 642456             0     0   37   51702          0       1            1   
 642457             0     0   21  175851          0       1            1   
 642458             0     0   45   75445          0       1            1   
 642459             0     0   46   75445          0       1            1   
 
         tiprel_1mes  indresi  indext  ...  ind_reca_fin_ult1_s  \
 0                 0        1       0  ...                    0   
 1                 0        1       0  ...                    1   
 2                 0        1       0  ...                    1   
 3                 0        1       0  ...                    1   
 4                 0        1       0  ...                    1   
 ...             ...      ...     ...  ...                  ...   
 642455            0        1       0  ...                    0   
 642456            0        1       0  ...                    0   
 642457            0        1       0  ...                    0   
 642458            0        1       0  ...                    0   
 642459            0        1       0  ...                    0   
 
         ind_tjcr_fin_ult1_s  ind_valo_fin_ult1_s  ind_viv_fin_ult1_s  \
 0                         0                    1                   0   
 1                         1                    1                   0   
 2                         1                    1                   0   
 3                         1                    1                   0   
 4                         1                    1                   0   
 ...                     ...                  ...                 ...   
 642455                    0                    0                   0   
 642456                    0                    0                   0   
 642457                    0                    0                   0   
 642458                    0                    0                   0   
 642459                    0                    0                   0   
 
         ind_nomina_ult1_s  ind_nom_pens_ult1_s  ind_recibo_ult1_s  month_int  \
 0                       0                    0                  0         15   
 1                       0                    0                  1          7   
 2                       0                    0                  1          8   
 3                       0                    0                  1          9   
 4                       0                    0                  1         10   
 ...                   ...                  ...                ...        ...   
 642455                  0                    0                  0         16   
 642456                  0                    0                  0         16   
 642457                  0                    0                  0         15   
 642458                  0                    0                  0         15   
 642459                  0                    0                  0         16   
 
              id                  y  
 0         15889  ind_tjcr_fin_ult1  
 1         15892   ind_cco_fin_ult1  
 2         15892   ind_cco_fin_ult1  
 3         15892   ind_cco_fin_ult1  
 4         15892   ind_cco_fin_ult1  
 ...         ...                ...  
 642455  1454607   ind_cno_fin_ult1  
 642456  1454607  ind_nom_pens_ult1  
 642457  1454608   ind_cco_fin_ult1  
 642458  1454615   ind_cno_fin_ult1  
 642459  1454615   ind_cno_fin_ult1  
 
 [642460 rows x 43 columns],
                id  ind_empleado  pais_residencia  sexo  age  ind_nuevo  \
 10649083    15889             3                0     0   56          0   
 10649181    15890             1                0     0   63          0   
 10649180    15892             3                0     1   62          0   
 10649179    15893             0                0     0   63          0   
 10649167    15894             1                0     0   60          0   
 ...           ...           ...              ...   ...  ...        ...   
 10824630  1454615             0                0     0   46          0   
 10540503  1454616             0                0     1   21          0   
 10607387  1454617             0                0     1   21          0   
 10205190  1454618             0                0     0   20          0   
 10460198  1454620             0                0     0   20          0   
 
           antiguedad  indrel  indrel_1mes  tiprel_1mes  ...  \
 10649083         255       1            1            0  ...   
 10649181         256       1            1            0  ...   
 10649180         256       1            1            0  ...   
 10649179         256       1            1            0  ...   
 10649167         256       1            1            0  ...   
 ...              ...     ...          ...          ...  ...   
 10824630           8       1            1            0  ...   
 10540503           8       1            1            0  ...   
 10607387           8       1            1            0  ...   
 10205190           8       1            1            1  ...   
 10460198           8       1            1            0  ...   
 
           ind_hip_fin_ult1_s  ind_plan_fin_ult1_s  ind_pres_fin_ult1_s  \
 10649083                   0                    0                    0   
 10649181                   0                    1                    0   
 10649180                   0                    0                    0   
 10649179                   0                    0                    0   
 10649167                   0                    0                    0   
 ...                      ...                  ...                  ...   
 10824630                   0                    0                    0   
 10540503                   0                    0                    0   
 10607387                   0                    0                    0   
 10205190                   0                    0                    0   
 10460198                   0                    0                    0   
 
           ind_reca_fin_ult1_s  ind_tjcr_fin_ult1_s  ind_valo_fin_ult1_s  \
 10649083                    0                    0                    1   
 10649181                    0                    1                    0   
 10649180                    1                    1                    1   
 10649179                    0                    0                    1   
 10649167                    1                    1                    1   
 ...                       ...                  ...                  ...   
 10824630                    0                    0                    0   
 10540503                    0                    0                    0   
 10607387                    0                    0                    0   
 10205190                    0                    0                    0   
 10460198                    0                    0                    0   
 
           ind_viv_fin_ult1_s  ind_nomina_ult1_s  ind_nom_pens_ult1_s  \
 10649083                   0                  0                    0   
 10649181                   0                  1                    1   
 10649180                   0                  0                    0   
 10649179                   0                  0                    0   
 10649167                   0                  1                    1   
 ...                      ...                ...                  ...   
 10824630                   0                  0                    0   
 10540503                   0                  0                    0   
 10607387                   0                  0                    0   
 10205190                   0                  0                    0   
 10460198                   0                  0                    0   
 
           ind_recibo_ult1_s  
 10649083                  0  
 10649181                  1  
 10649180                  1  
 10649179                  0  
 10649167                  1  
 ...                     ...  
 10824630                  0  
 10540503                  0  
 10607387                  0  
 10205190                  0  
 10460198                  0  
 
 [702435 rows x 79 columns])</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 3min 12s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ind_empleado</th>
      <th>sexo</th>
      <th>age</th>
      <th>renta</th>
      <th>ind_nuevo</th>
      <th>indrel</th>
      <th>indrel_1mes</th>
      <th>tiprel_1mes</th>
      <th>indresi</th>
      <th>indext</th>
      <th>conyuemp</th>
      <th>indfall</th>
      <th>tipodom</th>
      <th>ind_actividad_cliente</th>
      <th>segmento</th>
      <th>antiguedad</th>
      <th>pais_residencia</th>
      <th>canal_entrada</th>
      <th>ind_cco_fin_ult1_s</th>
      <th>ind_cder_fin_ult1_s</th>
      <th>ind_cno_fin_ult1_s</th>
      <th>ind_ctju_fin_ult1_s</th>
      <th>ind_ctma_fin_ult1_s</th>
      <th>ind_ctop_fin_ult1_s</th>
      <th>ind_ctpp_fin_ult1_s</th>
      <th>ind_deco_fin_ult1_s</th>
      <th>ind_deme_fin_ult1_s</th>
      <th>ind_dela_fin_ult1_s</th>
      <th>ind_ecue_fin_ult1_s</th>
      <th>ind_fond_fin_ult1_s</th>
      <th>ind_hip_fin_ult1_s</th>
      <th>ind_plan_fin_ult1_s</th>
      <th>ind_pres_fin_ult1_s</th>
      <th>ind_reca_fin_ult1_s</th>
      <th>ind_tjcr_fin_ult1_s</th>
      <th>ind_valo_fin_ult1_s</th>
      <th>ind_viv_fin_ult1_s</th>
      <th>ind_nomina_ult1_s</th>
      <th>ind_nom_pens_ult1_s</th>
      <th>ind_recibo_ult1_s</th>
      <th>month_int</th>
      <th>id</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>0</td>
      <td>56</td>
      <td>326124</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>245</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>15889</td>
      <td>ind_tjcr_fin_ult1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>0</td>
      <td>56</td>
      <td>326124</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>250</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>15889</td>
      <td>ind_tjcr_fin_ult1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0</td>
      <td>56</td>
      <td>326124</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>253</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
      <td>15889</td>
      <td>ind_tjcr_fin_ult1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>61</td>
      <td>430477</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>246</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>6</td>
      <td>15892</td>
      <td>ind_cco_fin_ult1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>1</td>
      <td>61</td>
      <td>430477</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>248</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9</td>
      <td>15892</td>
      <td>ind_dela_fin_ult1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>421949</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>21</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>1454615</td>
      <td>ind_cno_fin_ult1</td>
    </tr>
    <tr>
      <th>421950</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>21</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>1454615</td>
      <td>ind_nomina_ult1</td>
    </tr>
    <tr>
      <th>421951</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>21</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>1454615</td>
      <td>ind_nom_pens_ult1</td>
    </tr>
    <tr>
      <th>421952</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>21</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
      <td>1454615</td>
      <td>ind_nomina_ult1</td>
    </tr>
    <tr>
      <th>421953</th>
      <td>0</td>
      <td>0</td>
      <td>45</td>
      <td>75445</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>0</td>
      <td>21</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
      <td>1454615</td>
      <td>ind_nom_pens_ult1</td>
    </tr>
  </tbody>
</table>
<p>421954 rows × 43 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 34.2 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="n">test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>ind_empleado</th>
      <th>pais_residencia</th>
      <th>sexo</th>
      <th>age</th>
      <th>ind_nuevo</th>
      <th>antiguedad</th>
      <th>indrel</th>
      <th>indrel_1mes</th>
      <th>tiprel_1mes</th>
      <th>indresi</th>
      <th>indext</th>
      <th>conyuemp</th>
      <th>canal_entrada</th>
      <th>indfall</th>
      <th>tipodom</th>
      <th>cod_prov</th>
      <th>ind_actividad_cliente</th>
      <th>renta</th>
      <th>segmento</th>
      <th>ind_ahor_fin_ult1</th>
      <th>ind_aval_fin_ult1</th>
      <th>ind_cco_fin_ult1</th>
      <th>ind_cder_fin_ult1</th>
      <th>ind_cno_fin_ult1</th>
      <th>ind_ctju_fin_ult1</th>
      <th>ind_ctma_fin_ult1</th>
      <th>ind_ctop_fin_ult1</th>
      <th>ind_ctpp_fin_ult1</th>
      <th>ind_deco_fin_ult1</th>
      <th>ind_deme_fin_ult1</th>
      <th>ind_dela_fin_ult1</th>
      <th>ind_ecue_fin_ult1</th>
      <th>ind_fond_fin_ult1</th>
      <th>ind_hip_fin_ult1</th>
      <th>ind_plan_fin_ult1</th>
      <th>ind_pres_fin_ult1</th>
      <th>ind_reca_fin_ult1</th>
      <th>ind_tjcr_fin_ult1</th>
      <th>ind_valo_fin_ult1</th>
      <th>ind_viv_fin_ult1</th>
      <th>ind_nomina_ult1</th>
      <th>ind_nom_pens_ult1</th>
      <th>ind_recibo_ult1</th>
      <th>fecha_dato_month</th>
      <th>fecha_dato_year</th>
      <th>month_int</th>
      <th>fecha_alta_month</th>
      <th>fecha_alta_year</th>
      <th>fecha_alta_day</th>
      <th>fecha_alta_month_int</th>
      <th>fecha_alta_day_int</th>
      <th>ult_fec_cli_1t_month</th>
      <th>ult_fec_cli_1t_year</th>
      <th>ult_fec_cli_1t_day</th>
      <th>ult_fec_cli_1t_month_int</th>
      <th>id_shift</th>
      <th>ind_cco_fin_ult1_s</th>
      <th>ind_cder_fin_ult1_s</th>
      <th>ind_cno_fin_ult1_s</th>
      <th>ind_ctju_fin_ult1_s</th>
      <th>ind_ctma_fin_ult1_s</th>
      <th>ind_ctop_fin_ult1_s</th>
      <th>ind_ctpp_fin_ult1_s</th>
      <th>ind_deco_fin_ult1_s</th>
      <th>ind_deme_fin_ult1_s</th>
      <th>ind_dela_fin_ult1_s</th>
      <th>ind_ecue_fin_ult1_s</th>
      <th>ind_fond_fin_ult1_s</th>
      <th>ind_hip_fin_ult1_s</th>
      <th>ind_plan_fin_ult1_s</th>
      <th>ind_pres_fin_ult1_s</th>
      <th>ind_reca_fin_ult1_s</th>
      <th>ind_tjcr_fin_ult1_s</th>
      <th>ind_valo_fin_ult1_s</th>
      <th>ind_viv_fin_ult1_s</th>
      <th>ind_nomina_ult1_s</th>
      <th>ind_nom_pens_ult1_s</th>
      <th>ind_recibo_ult1_s</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10649083</th>
      <td>15889</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>56</td>
      <td>0</td>
      <td>255</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>326124</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15889</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10649181</th>
      <td>15890</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>63</td>
      <td>0</td>
      <td>256</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>71461</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15890</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10649180</th>
      <td>15892</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>62</td>
      <td>0</td>
      <td>256</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>430477</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15892</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10649179</th>
      <td>15893</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>63</td>
      <td>0</td>
      <td>256</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>430477</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>10</td>
      <td>2</td>
      <td>3</td>
      <td>34</td>
      <td>1033</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15893</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10649167</th>
      <td>15894</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>60</td>
      <td>0</td>
      <td>256</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>281757</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15894</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10824630</th>
      <td>1454615</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>46</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>21</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>75445</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454615</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10540503</th>
      <td>1454616</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>21</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>157</td>
      <td>0</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>132889</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454616</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10607387</th>
      <td>1454617</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>21</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>157</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>1</td>
      <td>58476</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454617</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10205190</th>
      <td>1454618</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>157</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>0</td>
      <td>75904</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454618</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10460198</th>
      <td>1454620</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>157</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>1</td>
      <td>52924</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454620</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>702435 rows × 79 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 31.6 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 01_data_preprocess.ipynb.
Converted 02_data_Cleaning.ipynb.
Converted 03_features.ipynb.
Converted 04_base_model.ipynb.
Converted index.ipynb.
time: 105 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

