---

title: Data preparation

keywords: fastai
sidebar: home_sidebar

summary: "Dieses Modul werden die Daten runtergeladen und für die Verarbeitung vorbereitet."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_data_prep.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Download-und-unzip-Data">Download und unzip Data<a class="anchor-link" href="#Download-und-unzip-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="download_santander_data" class="doc_header"><code>download_santander_data</code><a href="https://github.com/WFR/community_learning/tree/master/community_learning/data.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>download_santander_data</code>()</p>
</blockquote>
<p>downloads the data from gdrive to the data folder</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path_file</span> <span class="o">=</span> <span class="n">download_santander_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Downloading...
From: https://drive.google.com/uc?export=download&amp;id=1H-dFcuqI99OkXAawsTMkmylBz3exNUgZ
To: /home/wilhelm/CommunityLearning/data/raw/train_ver2.csv.zip
225MB [02:41, 1.39MB/s] 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="unzip" class="doc_header"><code>unzip</code><a href="https://github.com/WFR/community_learning/tree/master/community_learning/data.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>unzip</code>(<strong><code>path</code></strong>:<code>Path'&gt;, &lt;class 'str'&gt;]</code>, <strong><code>dest</code></strong>:<code>Path'&gt;, &lt;class 'str'&gt;]</code>=<em><code>'.'</code></em>)</p>
</blockquote>
<p>unzips a given file</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path_file</span> <span class="o">=</span> <span class="n">unzip</span><span class="p">(</span><span class="n">path_file</span><span class="p">,</span> <span class="n">path_file</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>extracted to data/raw/train_ver2.csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="clean-data">clean data<a class="anchor-link" href="#clean-data">&#182;</a></h2><p>Hierfür verwenden wir im Wesentlichen die Empfehlungen von <a href="https://www.kaggle.com/apryor6/detailed-cleaning-visualization-python">Alan Pryors Jupyter Notebook</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SandanderData" class="doc_header"><code>class</code> <code>SandanderData</code><a href="https://github.com/WFR/community_learning/tree/master/community_learning/data.py#L49" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SandanderData</code>()</p>
</blockquote>
<p>class which handles the data in a pipline style</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">SandanderData</span><span class="p">()</span>
        <span class="o">.</span><span class="n">load_csv</span><span class="p">(</span><span class="n">path_file</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
        <span class="o">.</span><span class="n">convert_dates</span><span class="p">()</span>
        <span class="o">.</span><span class="n">add_month_feature</span><span class="p">()</span>
        <span class="o">.</span><span class="n">add_age_feature</span><span class="p">()</span>
        <span class="o">.</span><span class="n">clean_age</span><span class="p">()</span>
        <span class="o">.</span><span class="n">clean_ind_nuevo</span><span class="p">()</span>
        <span class="o">.</span><span class="n">clean_antiguedad</span><span class="p">()</span>
        <span class="o">.</span><span class="n">replace_missing_dates_with_median</span><span class="p">()</span>
        <span class="o">.</span><span class="n">clean_indrel</span><span class="p">()</span>
        <span class="o">.</span><span class="n">drop_tipodom</span><span class="p">()</span>
        <span class="o">.</span><span class="n">clean_ind_actividad_cliente</span><span class="p">()</span>
        <span class="o">.</span><span class="n">clean_nomprov</span><span class="p">()</span>
       <span class="p">)</span>


<span class="c1">#tests</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="n">SandanderData</span>
<span class="k">assert</span> <span class="s2">&quot;age&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="k">assert</span> <span class="s2">&quot;month&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">fecha_dato</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;&lt;M8[ns]&#39;</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">fecha_alta</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;&lt;M8[ns]&#39;</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;found NAs in dataset&quot;</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">18</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">100</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">ind_nuevo</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">antiguedad</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">antiguedad</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">fecha_alta</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">indrel</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span>
<span class="k">assert</span> <span class="s2">&quot;tipodom&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ind_actividad_cliente&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export">&#182;</a></h2>
</div>
</div>
</div>
    {% endraw %}
</div>
 

