---

title: Community Learning

keywords: fastai
sidebar: home_sidebar

summary: "In diesem Notebook wird ein Ensemble von XGboost Modellen erstellt um die Prediction zu verbessern. "
description: "In diesem Notebook wird ein Ensemble von XGboost Modellen erstellt um die Prediction zu verbessern. "
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05_xgboost_simple_ensemble.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autotime
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Aufteilung-der-Daten">Aufteilung der Daten<a class="anchor-link" href="#Aufteilung-der-Daten"> </a></h2><p>Um die Daten möglichst konsitent zu teilen, werden wir für jede Kundenid den ursprünglichen Wohnort ermitteln. Wenn nun ein Kunde die Region in dem Untersuchungszeitraum wechselt, so wird nur der ursprüngliche Wohnort ausgewertet. So können wir sicherstellen, dass wir keine Daten durch die Aufteilung velieren. In dem Bild weiter unten sind die verschiedenen Regionen zu sehen. Wir werden versuchen Spanien in nördliche und südliche Regionen aufzuteilen.
<img src="/community_learning/data/images/spain.png" alt="image.png"></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 436 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 7.51 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 9.02 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_provice_data" class="doc_header"><code>load_provice_data</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_provice_data</code>(<strong><code>path</code></strong>:<code>str</code>=<em><code>'data/raw/train_ver2.csv'</code></em>)</p>
</blockquote>
<p>laden der Rohdaten für die Ermittlung der Aufteilung</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">load_provice_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 9.49 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="s1">&#39;ncodpers&#39;</span> <span class="ow">in</span> <span class="n">data</span>
<span class="k">assert</span> <span class="s1">&#39;nomprov&#39;</span> <span class="ow">in</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 7.96 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 18.7 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_region_to_nomprov" class="doc_header"><code>add_region_to_nomprov</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_region_to_nomprov</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>add a region column</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">add_region_to_nomprov</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ncodpers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">data1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">data1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>956645</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 1.18 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 15.1 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_data" class="doc_header"><code>load_data</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L92" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_data</code>(<strong><code>path_train</code></strong>=<em><code>'data/interim/03_train.csv'</code></em>, <strong><code>path_test</code></strong>=<em><code>'data/interim/03_test.csv'</code></em>)</p>
</blockquote>
<p>load data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_org</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 2.23 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 8.17 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_region_train_test" class="doc_header"><code>add_region_train_test</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L100" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_region_train_test</code>(<strong><code>train</code></strong>:<code>DataFrame</code>, <strong><code>test</code></strong>:<code>DataFrame</code>, <strong><code>region_df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>split train and test data by region</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">add_region_train_test</span><span class="p">(</span><span class="n">train_org</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">data1</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">train_org</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 464 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">south_ids</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train</span><span class="o">.</span><span class="n">region</span><span class="o">==</span><span class="s1">&#39;south&#39;</span><span class="p">,][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">north_ids</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train</span><span class="o">.</span><span class="n">region</span><span class="o">==</span><span class="s1">&#39;north&#39;</span><span class="p">,][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">([</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">south_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">north_ids</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">south_id</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">south_ids</span><span class="p">)</span> <span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
time: 46.5 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">product_dict</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">get_product_dict</span><span class="p">(</span><span class="n">train_org</span><span class="p">)</span>
<span class="n">product_reverse_dict</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">get_product_reverse_dict</span><span class="p">(</span><span class="n">train_org</span><span class="p">)</span>    
<span class="n">train</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">encode_products</span><span class="p">(</span><span class="n">train_org</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 139 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">region_df</span> <span class="o">=</span> <span class="n">load_provice_data</span><span class="p">()</span>
<span class="n">region_df</span> <span class="o">=</span> <span class="n">add_region_to_nomprov</span><span class="p">(</span><span class="n">region_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 9.78 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train1</span><span class="p">,</span> <span class="n">test1</span> <span class="o">=</span> <span class="n">add_region_train_test</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">region_df</span><span class="p">)</span>

<span class="n">train_X_south</span><span class="p">,</span> <span class="n">train_y_south</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">x_y_split</span><span class="p">(</span><span class="n">train1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train1</span><span class="o">.</span><span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;south&#39;</span><span class="p">,]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
<span class="n">train_X_north</span><span class="p">,</span> <span class="n">train_y_north</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">x_y_split</span><span class="p">(</span><span class="n">train1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train1</span><span class="o">.</span><span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;north&#39;</span><span class="p">,]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_X_south</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_X_north</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_X_south</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_X_north</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 795 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_south</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">runXGB</span><span class="p">(</span><span class="n">train_X_south</span><span class="p">,</span> <span class="n">train_y_south</span><span class="p">,</span> <span class="n">base_model</span><span class="o">.</span><span class="n">feature_cols</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model_north</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">runXGB</span><span class="p">(</span><span class="n">train_X_north</span><span class="p">,</span> <span class="n">train_y_north</span><span class="p">,</span> <span class="n">base_model</span><span class="o">.</span><span class="n">feature_cols</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 19.1 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 15.8 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_two_region_data" class="doc_header"><code>get_two_region_data</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L109" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_two_region_data</code>(<strong><code>source_train</code></strong>:<code>str</code>=<em><code>'data/interim/03_train.csv'</code></em>, <strong><code>source_test</code></strong>:<code>str</code>=<em><code>'data/interim/03_test.csv'</code></em>, <strong><code>source_raw</code></strong>:<code>str</code>=<em><code>'data/raw/train_ver2.csv'</code></em>)</p>
</blockquote>
<p>returns X, y data for each region</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">get_two_region_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>load data
prepare data
time: 18.6 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;product_dict&#39;, &#39;product_reverse_dict&#39;, &#39;feature_cols&#39;, &#39;target_cols&#39;, &#39;train&#39;, &#39;test&#39;, &#39;train_south&#39;, &#39;train_north&#39;, &#39;train_X_south&#39;, &#39;train_y_south&#39;, &#39;train_X_north&#39;, &#39;train_y_north&#39;, &#39;train_X&#39;, &#39;train_y&#39;, &#39;test_south&#39;, &#39;test_north&#39;])</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 8.48 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simple-Ensemble">Simple Ensemble<a class="anchor-link" href="#Simple-Ensemble"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 18.5 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_two_region_base_models" class="doc_header"><code>get_two_region_base_models</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L145" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_two_region_base_models</code>(<strong><code>data</code></strong>:<code>dict</code>, <strong><code>dest_model_south</code></strong>:<code>str</code>=<em><code>'data/results/model_south.dat'</code></em>, <strong><code>dest_model_north</code></strong>:<code>str</code>=<em><code>'data/results/model_north.dat'</code></em>, <strong><code>use_gpu</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>load data, assign region, and train model per region</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">get_two_region_base_models</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>train model south
train model north
train model all
time: 1min 21s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 7.76 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_prediction" class="doc_header"><code>get_prediction</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L181" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_prediction</code>(<strong><code>model</code></strong>, <strong><code>data</code></strong>, <strong><code>feature_cols</code></strong>)</p>
</blockquote>
<p>returns the results for two region model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">get_prediction</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;model_south&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;test_south&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature_cols&#39;</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;test_south&#39;</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;target_cols&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 4.25 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 10.9 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate_predictions" class="doc_header"><code>evaluate_predictions</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L187" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate_predictions</code>(<strong><code>preds</code></strong>, <strong><code>test_data</code></strong>, <strong><code>target_cols</code></strong>, <strong><code>product_reverse_dict</code></strong>)</p>
</blockquote>
<p>evaluates map metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">evaluate_predictions</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;test_south&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target_cols&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;product_reverse_dict&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.0267273495497508</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 29.6 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">get_two_region_data</span><span class="p">()</span>
<span class="n">models</span> <span class="o">=</span> <span class="n">get_two_region_base_models</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>load data
prepare data
train model south
train model north
time: 34.4 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>ind_empleado</th>
      <th>pais_residencia</th>
      <th>sexo</th>
      <th>age</th>
      <th>ind_nuevo</th>
      <th>antiguedad</th>
      <th>indrel</th>
      <th>indrel_1mes</th>
      <th>tiprel_1mes</th>
      <th>indresi</th>
      <th>indext</th>
      <th>conyuemp</th>
      <th>canal_entrada</th>
      <th>indfall</th>
      <th>tipodom</th>
      <th>cod_prov</th>
      <th>ind_actividad_cliente</th>
      <th>renta</th>
      <th>segmento</th>
      <th>ind_ahor_fin_ult1</th>
      <th>ind_aval_fin_ult1</th>
      <th>ind_cco_fin_ult1</th>
      <th>ind_cder_fin_ult1</th>
      <th>ind_cno_fin_ult1</th>
      <th>ind_ctju_fin_ult1</th>
      <th>ind_ctma_fin_ult1</th>
      <th>ind_ctop_fin_ult1</th>
      <th>ind_ctpp_fin_ult1</th>
      <th>ind_deco_fin_ult1</th>
      <th>ind_deme_fin_ult1</th>
      <th>ind_dela_fin_ult1</th>
      <th>ind_ecue_fin_ult1</th>
      <th>ind_fond_fin_ult1</th>
      <th>ind_hip_fin_ult1</th>
      <th>ind_plan_fin_ult1</th>
      <th>ind_pres_fin_ult1</th>
      <th>ind_reca_fin_ult1</th>
      <th>ind_tjcr_fin_ult1</th>
      <th>ind_valo_fin_ult1</th>
      <th>ind_viv_fin_ult1</th>
      <th>ind_nomina_ult1</th>
      <th>ind_nom_pens_ult1</th>
      <th>ind_recibo_ult1</th>
      <th>fecha_dato_month</th>
      <th>fecha_dato_year</th>
      <th>month_int</th>
      <th>fecha_alta_month</th>
      <th>fecha_alta_year</th>
      <th>fecha_alta_day</th>
      <th>fecha_alta_month_int</th>
      <th>fecha_alta_day_int</th>
      <th>ult_fec_cli_1t_month</th>
      <th>ult_fec_cli_1t_year</th>
      <th>ult_fec_cli_1t_day</th>
      <th>ult_fec_cli_1t_month_int</th>
      <th>id_shift</th>
      <th>ind_cco_fin_ult1_s</th>
      <th>ind_cder_fin_ult1_s</th>
      <th>ind_cno_fin_ult1_s</th>
      <th>ind_ctju_fin_ult1_s</th>
      <th>ind_ctma_fin_ult1_s</th>
      <th>ind_ctop_fin_ult1_s</th>
      <th>ind_ctpp_fin_ult1_s</th>
      <th>ind_deco_fin_ult1_s</th>
      <th>ind_deme_fin_ult1_s</th>
      <th>ind_dela_fin_ult1_s</th>
      <th>ind_ecue_fin_ult1_s</th>
      <th>ind_fond_fin_ult1_s</th>
      <th>ind_hip_fin_ult1_s</th>
      <th>ind_plan_fin_ult1_s</th>
      <th>ind_pres_fin_ult1_s</th>
      <th>ind_reca_fin_ult1_s</th>
      <th>ind_tjcr_fin_ult1_s</th>
      <th>ind_valo_fin_ult1_s</th>
      <th>ind_viv_fin_ult1_s</th>
      <th>ind_nomina_ult1_s</th>
      <th>ind_nom_pens_ult1_s</th>
      <th>ind_recibo_ult1_s</th>
      <th>nomprov</th>
      <th>region</th>
      <th>added_products</th>
      <th>truth_list</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15889</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>56</td>
      <td>0</td>
      <td>255</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>326124</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15889</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MADRID</td>
      <td>south</td>
      <td>[ind_recibo_ult1, ind_tjcr_fin_ult1, ind_fond_...</td>
      <td>[ind_tjcr_fin_ult1]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15890</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>63</td>
      <td>0</td>
      <td>256</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>71461</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15890</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>MADRID</td>
      <td>south</td>
      <td>[ind_cco_fin_ult1, ind_dela_fin_ult1, ind_reca...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15892</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>62</td>
      <td>0</td>
      <td>256</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>430477</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15892</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>MADRID</td>
      <td>south</td>
      <td>[ind_nom_pens_ult1, ind_ctop_fin_ult1, ind_nom...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15893</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>63</td>
      <td>0</td>
      <td>256</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>430477</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>10</td>
      <td>2</td>
      <td>3</td>
      <td>34</td>
      <td>1033</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15893</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MADRID</td>
      <td>south</td>
      <td>[ind_cco_fin_ult1, ind_tjcr_fin_ult1, ind_reci...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15894</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>60</td>
      <td>0</td>
      <td>256</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>281757</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>0</td>
      <td>16</td>
      <td>1</td>
      <td>46</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>15894</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>MADRID</td>
      <td>south</td>
      <td>[ind_cno_fin_ult1, ind_fond_fin_ult1, ind_valo...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>702430</th>
      <td>1454615</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>46</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>21</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>75445</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454615</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>BARCELONA</td>
      <td>north</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>702431</th>
      <td>1454616</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>21</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>157</td>
      <td>0</td>
      <td>1</td>
      <td>9</td>
      <td>1</td>
      <td>132889</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454616</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>BURGOS</td>
      <td>north</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>702432</th>
      <td>1454617</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>21</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>157</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>1</td>
      <td>58476</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454617</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>CADIZ</td>
      <td>south</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>702433</th>
      <td>1454618</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>157</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>0</td>
      <td>75904</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454618</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MADRID</td>
      <td>south</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>702434</th>
      <td>1454620</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
      <td>0</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>157</td>
      <td>0</td>
      <td>1</td>
      <td>10</td>
      <td>1</td>
      <td>52924</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>9</td>
      <td>20</td>
      <td>18</td>
      <td>249</td>
      <td>7588</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
      <td>1454620</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>CACERES</td>
      <td>north</td>
      <td>NaN</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
<p>702435 rows × 83 columns</p>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 52.6 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model_south&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;model_north&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;model_all&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;model_south_north_combine&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]}</span> 
  
<span class="c1"># Creates pandas DataFrame. </span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;test_south&#39;</span><span class="p">,</span> <span class="s1">&#39;test_north&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">])</span> 
<span class="n">results_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model_south</th>
      <th>model_north</th>
      <th>model_all</th>
      <th>model_south_north_combine</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>test_south</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>test_north</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>test</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 24.9 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 8.34 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fill_results" class="doc_header"><code>fill_results</code><a href="https://github.com/submitCode/community_learning/tree/master/community_learning/example.py#L203" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fill_results</code>(<strong><code>model_label</code></strong>, <strong><code>data_label</code></strong>, <strong><code>data</code></strong>, <strong><code>models</code></strong>, <strong><code>results_df</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fill_results_ensemble</span><span class="p">(</span><span class="n">model1_label</span><span class="p">,</span> <span class="n">model2_label</span><span class="p">,</span> <span class="n">data_label</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">):</span>
    <span class="n">model1</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">model1_label</span><span class="p">]</span>
    <span class="n">model2</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">model2_label</span><span class="p">]</span>
    <span class="n">dat</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data_label</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">preds1</span> <span class="o">=</span> <span class="n">get_prediction</span><span class="p">(</span><span class="n">model1</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature_cols&#39;</span><span class="p">])</span>
    <span class="n">preds2</span> <span class="o">=</span> <span class="n">get_prediction</span><span class="p">(</span><span class="n">model2</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;feature_cols&#39;</span><span class="p">])</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">preds1</span> <span class="o">+</span> <span class="n">preds2</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate_predictions</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target_cols&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;product_reverse_dict&#39;</span><span class="p">])</span>
    <span class="n">results_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_label</span><span class="p">,</span> <span class="s1">&#39;model_south_north_combine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">results_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 20.2 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results_ensemble</span><span class="p">(</span><span class="s1">&#39;model_south&#39;</span><span class="p">,</span> <span class="s1">&#39;model_north&#39;</span><span class="p">,</span> <span class="s1">&#39;test_south&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results_ensemble</span><span class="p">(</span><span class="s1">&#39;model_south&#39;</span><span class="p">,</span> <span class="s1">&#39;model_north&#39;</span><span class="p">,</span> <span class="s1">&#39;test_north&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results_ensemble</span><span class="p">(</span><span class="s1">&#39;model_south&#39;</span><span class="p">,</span> <span class="s1">&#39;model_north&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>            model_south  model_north  model_all  model_south_north_combine
test_south            1            1          1                   0.026649
test_north            1            1          1                   1.000000
test                  1            1          1                   1.000000
            model_south  model_north  model_all  model_south_north_combine
test_south            1            1          1                   0.026649
test_north            1            1          1                   0.018006
test                  1            1          1                   1.000000
            model_south  model_north  model_all  model_south_north_combine
test_south            1            1          1                   0.026649
test_north            1            1          1                   0.018006
test                  1            1          1                   0.022984
time: 2min 13s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_south&#39;</span><span class="p">,</span> <span class="s1">&#39;test_south&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_south&#39;</span><span class="p">,</span> <span class="s1">&#39;test_north&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_south&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>


<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_north&#39;</span><span class="p">,</span> <span class="s1">&#39;test_south&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_north&#39;</span><span class="p">,</span> <span class="s1">&#39;test_north&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_north&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>


<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_all&#39;</span><span class="p">,</span> <span class="s1">&#39;test_south&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_all&#39;</span><span class="p">,</span> <span class="s1">&#39;test_north&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">fill_results</span><span class="p">(</span><span class="s1">&#39;model_all&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">results_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727            1          1                   0.026649
test_north     1.000000            1          1                   0.018006
test           1.000000            1          1                   0.022984
            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727            1          1                   0.026649
test_north     0.017951            1          1                   0.018006
test           1.000000            1          1                   0.022984
            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727            1          1                   0.026649
test_north     0.017951            1          1                   0.018006
test           0.023006            1          1                   0.022984
            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727     0.026502          1                   0.026649
test_north     0.017951     1.000000          1                   0.018006
test           0.023006     1.000000          1                   0.022984
            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727     0.026502          1                   0.026649
test_north     0.017951     0.018017          1                   0.018006
test           0.023006     1.000000          1                   0.022984
            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727     0.026502          1                   0.026649
test_north     0.017951     0.018017          1                   0.018006
test           0.023006     0.022904          1                   0.022984
            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727     0.026502    0.02669                   0.026649
test_north     0.017951     0.018017    1.00000                   0.018006
test           0.023006     0.022904    1.00000                   0.022984
            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727     0.026502   0.026690                   0.026649
test_north     0.017951     0.018017   0.017983                   0.018006
test           0.023006     0.022904   1.000000                   0.022984
            model_south  model_north  model_all  model_south_north_combine
test_south     0.026727     0.026502   0.026690                   0.026649
test_north     0.017951     0.018017   0.017983                   0.018006
test           0.023006     0.022904   0.022998                   0.022984
time: 5min 51s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;distributed_lgbm_training&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.026443885421329187</span><span class="p">,</span> <span class="mf">0.017835593289980797</span><span class="p">,</span> <span class="mf">0.022793803380779395</span><span class="p">]</span>
<span class="n">results_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/final/results_df.csv&#39;</span><span class="p">)</span>
<span class="n">results_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model_south</th>
      <th>model_north</th>
      <th>model_all</th>
      <th>model_south_north_combine</th>
      <th>distributed_lgbm_training</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>test_south</th>
      <td>0.026727</td>
      <td>0.026502</td>
      <td>0.026690</td>
      <td>0.026649</td>
      <td>0.026444</td>
    </tr>
    <tr>
      <th>test_north</th>
      <td>0.017951</td>
      <td>0.018017</td>
      <td>0.017983</td>
      <td>0.018006</td>
      <td>0.017836</td>
    </tr>
    <tr>
      <th>test</th>
      <td>0.023006</td>
      <td>0.022904</td>
      <td>0.022998</td>
      <td>0.022984</td>
      <td>0.022794</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 13.7 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 01_data_preprocess.ipynb.
Converted 02_data_Cleaning.ipynb.
Converted 03_features.ipynb.
Converted 04_base_model - Versuch CCA.ipynb.
Converted 04_base_model.ipynb.
Converted 05_xgboost_simple_ensemble.ipynb.
This cell doesn&#39;t have an export destination and was ignored:
e
Converted 06_Distributed_ML.ipynb.
Converted index.ipynb.
time: 116 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

